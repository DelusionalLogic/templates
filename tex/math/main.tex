\documentclass[preview]{standalone}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{stmaryrd}
\begin{document}
$\mathcal{T}$ is the set of all valid traces for a given network
\begin{align*}
	D(s) &: \bigcup_{\substack{out \in I^{out}_s \\in \in I^{in}_s}}D(in : s : out)
		\\
	D(in : s :) &: \bigcup_{out \in I^{out}_s}D(in : s : out)
		\\
	D(: s : out) &: \bigcup_{in \in I^{in}_s}D(in : s : out)
		\\
		D(in_q : s_q : out_q) &: 
		\begin{aligned}[t]
			\bigl\{ (s, in, h_1, out, h_2, F) &\mid{}
			in_q = in \wedge{} s_q = s \wedge{} out_q = out \\
			&\wedge{} (s, in, h_1, out, h_2, F) \in{} \mathcal{T} \bigr\}
		\end{aligned}
		\\
		\\
	P(e_s) &: D(e_s)
		\\
	P(e_p > e_s) &: \left\{ xy \mid x \in P(e_p) \wedge{} y \in{}
		D(e_s) \wedge{} xy \in{} \mathcal{T} \right\}
		\\
	P(e_p >> e_s) &: \left\{ xzy \mid{} x \in{} P(e_p) \wedge{} y \in{}
		D(e_s) \wedge{} z \in{} \mathcal{T} \wedge{} xzy \in{} \mathcal{T}
		\right\}
		\\
		\\
		Q(e_h^1 e_p e_h^2) &: 
		\begin{aligned}[t]
			\bigl\{ xyz &\mid{}
			x = (s^1, in^x, h_1^x, out^x, h_2^x, F^x)\\
			&\wedge{}z = (s^z, in^z, h_1^z, out^z, h_2^z, F^z)\\
			&\wedge{} h_1^x \in \left\llbracket e_h^1 \right\rrbracket\\
			&\wedge{} h_2^z \in \left\llbracket e_h^2 \right\rrbracket\\
			&\wedge{} xyz \in \mathcal{T}
			\bigr\}
		\end{aligned}
\end{align*}
\end{document}
